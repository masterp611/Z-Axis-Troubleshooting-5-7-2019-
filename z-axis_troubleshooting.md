# Z-Axis Troubleshooting (5-7-2019)

The liquid handling robot was moved from the basement to the lab on 5-4-2019, so the first thing we wanted to do at our 5-7-2019 meeting was to test all the axes.

When testing the z-axis we noticed that it moved down smoothly, however, when moving up, it would stall a couple inches below the limit switch. We surmised that it was stalling because the stepper motor wasn't providing enough torque to overcome gravity and lateral forces caused by misalignment between the lead screw and the frame.

We checked that the current in the config file was set to the max current rating of the motor (1.5 A) and it was. [Z-axis motor specs.](https://www.alibaba.com/product-detail/42SHD0217-250NJ-stepper-motor-lead-screw_1117354038.html) We checked current because torque and current are directly proportional, so if the max current wasn't flowing to the motor then we weren't getting the max torque.

When checking the config file, we noticed that the steps/mm was set to 1600. To verify that this value was correct we calculated it based on the motor's 1.8 deg step angle and the lead screw's 2 mm pitch. We calculated 100 steps/mm (significantly different than 1600), so we changed it in the config file. We then increased the max feed rate to 6000 mm/min because with this new steps/mm value the previously set 600 mm/min max rate was too slow. With our new 100 mm/step value the axis was not moving very far even when we commanded it to move 1000 mm, so we knew something wasn't right. We changed it back to 1600 steps/mm and realized that is was moving ~14.5 mm when we commanded it to move 10 mm. **In order to correct this we adjusted the step/mm to 1600/1.45 = 1103 steps/mm. We adjusted the max feed rate based on the fact that speed and torque are inversely proportional.** We're not exactly sure why there was such a big difference between the 1600 steps/mm that we found in the config file and the 100 steps/mm we calculated.

We ended up lubricating the lead screw with gear oil. We also untightened the socket head cap screws, attaching it to the acrylic frame, to relieve any binding forces between the lead screw and frame. We ran the motor a couple of times and then retightened the cap screws. The z-axis ran smoothly and its travel distance matched our input. If the max feed rate is increased in the config file, keep in mind that at some point the torque will be too low to overcome gravity/binding forces.
